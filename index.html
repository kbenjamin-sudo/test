<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>StudyOS | Professional Study Sheets</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root {
            --bg: #0a0b10; --sidebar: #11121a; --card: #1c1e29;
            --accent: #6366f1; --accent-hover: #818cf8;
            --text: #f8fafc; --muted: #94a3b8; --border: #2d313e;
        }
        * { box-sizing: border-box; font-family: 'Inter', system-ui, -apple-system, sans-serif; }
        body { margin: 0; background: var(--bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; }

        /* Sidebar */
        aside { width: 300px; background: var(--sidebar); border-right: 1px solid var(--border); display: flex; flex-direction: column; padding: 20px; }
        .logo { font-size: 1.5rem; font-weight: 800; margin-bottom: 30px; color: var(--accent); letter-spacing: -1px; }
        #note-list { flex: 1; overflow-y: auto; }
        .note-item { 
            padding: 12px; border-radius: 10px; cursor: pointer; margin-bottom: 8px;
            border: 1px solid transparent; transition: 0.2s; display: flex; justify-content: space-between; align-items: center;
        }
        .note-item:hover { background: var(--card); border-color: var(--border); }
        .note-item.active { background: var(--accent); color: white; }
        .fav-badge { color: #fbbf24; font-size: 1.2rem; }

        /* Main Workspace */
        main { flex: 1; display: flex; flex-direction: column; padding: 40px; overflow-y: auto; }
        .workspace-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .controls { display: flex; gap: 10px; }
        
        .editor-container { max-width: 900px; margin: 0 auto; width: 100%; }
        input#note-title { 
            background: transparent; border: none; font-size: 2.5rem; font-weight: 700; 
            color: var(--text); width: 100%; outline: none; margin-bottom: 10px;
        }
        textarea#note-body { 
            background: var(--card); border: 1px solid var(--border); border-radius: 16px;
            width: 100%; height: 60vh; padding: 30px; color: var(--text); font-size: 1.1rem;
            line-height: 1.7; outline: none; resize: none; transition: border-color 0.3s;
        }
        textarea#note-body:focus { border-color: var(--accent); }

        /* Buttons */
        button { 
            padding: 10px 18px; border-radius: 8px; border: none; cursor: pointer; 
            font-weight: 600; font-size: 0.9rem; transition: 0.2s; display: flex; align-items: center; gap: 6px;
        }
        .btn-new { background: var(--accent); color: white; width: 100%; margin-bottom: 20px; justify-content: center; }
        .btn-save { background: #10b981; color: white; }
        .btn-export { background: #6366f1; color: white; }
        .btn-del { background: #ef4444; color: white; }
        .btn-fav { background: #334155; color: white; }
        button:hover { filter: brightness(1.1); transform: translateY(-1px); }

        /* Focus Mode */
        body.focus-mode aside { display: none; }
        body.focus-mode main { padding: 60px 10%; }
    </style>
</head>
<body>

<aside>
    <div class="logo">StudyOS.</div>
    <button class="btn-new" onclick="createNewNote()">+ New Study Sheet</button>
    <div id="note-list"></div>
    <div style="margin-top: 20px;">
        <button class="btn-fav" style="width:100%; justify-content: center;" onclick="toggleFocus()">Toggle Focus Mode</button>
    </div>
</aside>

<main>
    <div class="workspace-header">
        <div class="status" id="save-status" style="color: var(--muted); font-size: 0.8rem;">Ready</div>
        <div class="controls">
            <button class="btn-fav" onclick="toggleFavorite()">‚≠ê Favorite</button>
            <button class="btn-export" onclick="exportPDF()">üìÑ PDF</button>
            <button class="btn-save" onclick="saveNote()">Save</button>
            <button class="btn-del" onclick="deleteNote()">Delete</button>
        </div>
    </div>

    <div class="editor-container">
        <input type="text" id="note-title" placeholder="Topic: Quantum Physics...">
        <textarea id="note-body" placeholder="Drop your knowledge here... Use dashes for points, or just start writing."></textarea>
    </div>
</main>

<script>
    let notes = JSON.parse(localStorage.getItem('study_sheets') || '[]');
    let currentNoteId = null;

    // --- CORE LOGIC ---
    function createNewNote() {
        const newNote = {
            id: Date.now().toString(),
            title: "",
            content: "",
            favorite: false,
            lastUpdated: new Date().toISOString()
        };
        notes.unshift(newNote);
        currentNoteId = newNote.id;
        renderNoteList();
        loadNoteIntoEditor(newNote.id);
    }

    function saveNote() {
        const title = document.getElementById('note-title').value;
        const content = document.getElementById('note-body').value;
        
        if (!currentNoteId && !title) return;

        const index = notes.findIndex(n => n.id === currentNoteId);
        if (index > -1) {
            notes[index].title = title || "Untitled Sheet";
            notes[index].content = content;
            notes[index].lastUpdated = new Date().toISOString();
        }

        localStorage.setItem('study_sheets', JSON.stringify(notes));
        renderNoteList();
        
        const status = document.getElementById('save-status');
        status.innerText = "Changes saved locally";
        setTimeout(() => status.innerText = "Ready", 2000);
    }

    function loadNoteIntoEditor(id) {
        currentNoteId = id;
        const note = notes.find(n => n.id === id);
        document.getElementById('note-title').value = note.title;
        document.getElementById('note-body').value = note.content;
        renderNoteList();
    }

    function deleteNote() {
        if (!currentNoteId) return;
        if (confirm("Delete this study sheet forever?")) {
            notes = notes.filter(n => n.id !== currentNoteId);
            currentNoteId = null;
            document.getElementById('note-title').value = "";
            document.getElementById('note-body').value = "";
            localStorage.setItem('study_sheets', JSON.stringify(notes));
            renderNoteList();
        }
    }

    function toggleFavorite() {
        if (!currentNoteId) return;
        const note = notes.find(n => n.id === currentNoteId);
        note.favorite = !note.favorite;
        saveNote();
    }

    function toggleFocus() {
        document.body.classList.toggle('focus-mode');
    }

    // --- UI RENDERING ---
    function renderNoteList() {
        const list = document.getElementById('note-list');
        list.innerHTML = notes.map(n => `
            <div class="note-item ${n.id === currentNoteId ? 'active' : ''}" onclick="loadNoteIntoEditor('${n.id}')">
                <span>${n.title || 'Untitled'}</span>
                ${n.favorite ? '<span class="fav-badge">‚òÖ</span>' : ''}
            </div>
        `).join('');
    }

    // --- PDF EXPORT ---
    function exportPDF() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();
        const title = document.getElementById('note-title').value || "Study Sheet";
        const body = document.getElementById('note-body').value;

        doc.setFont("helvetica", "bold");
        doc.setFontSize(22);
        doc.text(title.toUpperCase(), 20, 30);
        
        doc.setLineWidth(0.5);
        doc.line(20, 35, 190, 35);

        doc.setFont("helvetica", "normal");
        doc.setFontSize(12);
        const splitContent = doc.splitTextToSize(body, 170);
        doc.text(splitContent, 20, 50);

        doc.save(`${title.replace(/\s+/g, '_')}_StudySheet.pdf`);
    }

    // Init
    if (notes.length > 0) {
        loadNoteIntoEditor(notes[0].id);
    } else {
        createNewNote();
    }
</script>
</body>
</html>
